import{d as X,r as C,A as Y,B as Z,a as ee,b as E,e as h,C as T,f as J,g as t,w as o,v as ae,D as te,F as le,c as s,E as oe,i as $,t as f,G as b,H as ue,I as re,J as se,y as l,K as I,x as d,p as c,m as ne,n as _,L as ce,q as V,M as de,k as N,_ as ie}from"./index-565d8451.js";import{C as O}from"./CopyLabel-c6345122.js";import{v as me}from"./v4-a960c1f4.js";const fe={class:"w-25"},pe={key:0},ge={style:{display:"flex","justify-content":"space-between"}},he=X({__name:"CourseDataPage",setup(ve){let u=C(!1),n=C([]),i=C([]),p=C([]);const m=Y(),F=Z(),D=C(""),x=C([]),k=C([]);ee(()=>{P()});function P(){E.get("http://localhost:8089/getCourseData").then(e=>{e.data.code===200?(h(e.data.message,"success"),n.value=e.data.data,localStorage.setItem("courseData",JSON.stringify(n.value))):h(e.data.message,"error")}).catch(e=>{h(e.message,"error")})}function w(){return p.value.length==0&&i.value.length==0&&k.value.length==0?(h("未修改数据","warning"),!0):!1}const q=T(()=>[...n.value,...i.value].filter(e=>!D.value||e.courseName.toLowerCase().includes(D.value.toLowerCase()))),H=T(()=>({"--el-table-tr-bg-color":(m.darkTheme,"null"),"--el-table-bg-color":(m.darkTheme,"null"),"--el-table-header-bg-color":(m.darkTheme,"null"),"--el-table-text-color":m.darkTheme?"#ffffff":"null","--el-table-row-hover-bg-color":m.darkTheme?"#39475e":"#f5f7fa","--el-table-border-color":m.darkTheme?"#253458":"#ebeef5"})),B=T(()=>({width:"350px","--el-input-bg-color":m.darkTheme?"#1c2742":"#ffffff","--el-input-text-color":m.darkTheme?"#ffffff":"#000000","--el-input-border-color":m.darkTheme?"#b4a8ff":F.themes.value.light.colors.primary})),j=T(()=>({"--el-switch-off-color":"#dcdfe6"})),A=(e,r)=>r.courseSpecialized===e;function U(){u.value=!u.value}function L(){var g;const e=((g=localStorage.getItem("courseData"))==null?void 0:g.trim())??"[]",r=JSON.parse(e);if(r.length!==n.value.length){k.value=n.value;return}for(let v=0;v<n.value.length;++v){const z=r[v],S=n.value[v];if(!z&&!S)continue;let a=!1;const y=["courseName","courseVenue","courseSpecialized"];for(let M of y)if(z[M]!==S[M]){a=!0;break}a&&k.value.push(S)}}function G(){L(),!w()&&(p.value=p.value.filter(e=>typeof e!="string"),i.value.forEach(e=>{e.courseId=null}),E.post("http://localhost:8089/modifyCourseData",{deleteCourseData:p.value,diffCourse:k.value,addCourseData:i.value}).then(e=>{if(e.data.code===200)h(e.data.message,"success"),p.value=[],k.value=[],n.value=[...n.value,...i.value],i.value=[],localStorage.setItem("courseData",JSON.stringify(n.value));else if(e.data.code===901){let r=e.data.message.replace(/\n|\r\n/g,"<br>");de.alert(r,e.data.data,{confirmButtonText:"了解",dangerouslyUseHTMLString:!0,callback:()=>{h(e.data.data,"error")}})}else h(e.data.message,"error")}).catch(e=>{console.log(e)}))}function K(){var e;L(),!w()&&(n.value=(e=localStorage.getItem("courseData"))!=null&&e.trim()?JSON.parse(localStorage.getItem("courseData").trim()):[],i.value=[],p.value=[],k.value=[])}function Q(){i.value.push({courseSpecialized:!1,courseId:me(),courseName:"",courseVenue:""})}function R(){const e=x.value.map(r=>r.courseId);if(e.length===0){h("没有勾选数据","warning");return}n.value=n.value.filter(r=>!e.includes(r.courseId)),i.value=i.value.filter(r=>!e.includes(r.courseId)),p.value=p.value.concat(e)}function W(e){x.value=e}return(e,r)=>{const g=N("el-table-column"),v=N("el-input"),z=N("el-switch"),S=N("el-table");return s(),J(le,null,[t(ae,null,{default:o(()=>[t(oe,{class:"font-weight-bold"},{default:o(()=>[$("span",null,f(e.$t("menu.data.courseData.courseData")),1),t(b),$("div",fe,[t(ue,{modelValue:D.value,"onUpdate:modelValue":r[0]||(r[0]=a=>D.value=a),placeholder:e.$t("menu.data.courseData.search"),clearable:"",density:"compact","hide-details":"","prepend-inner-icon":"mdi-magnify","single-line":"",variant:"solo"},null,8,["modelValue","placeholder"])])]),_:1}),t(re),t(se,{class:"table-container"},{default:o(()=>[t(S,{data:l(q),"default-sort":{prop:"courseId",order:"desc"},style:I(l(H)),onSelectionChange:W},{default:o(()=>[l(u)?(s(),d(g,{key:0,type:"selection",width:"55"})):c("",!0),t(g,{label:e.$t("menu.data.courseData.courseId"),prop:"courseId",width:"200px"},{default:o(({row:a})=>[t(O,{text:"#"+a.courseId},null,8,["text"])]),_:1},8,["label"]),t(g,{label:e.$t("menu.data.courseData.courseName"),prop:"courseName"},{default:o(({row:a})=>[l(u)?c("",!0):(s(),d(O,{key:0,text:a.courseName},null,8,["text"])),l(u)?(s(),d(v,{key:1,modelValue:a.courseName,"onUpdate:modelValue":y=>a.courseName=y,style:I(l(B))},null,8,["modelValue","onUpdate:modelValue","style"])):c("",!0)]),_:1},8,["label"]),t(g,{label:e.$t("menu.data.courseData.courseVenue"),prop:"courseVenue"},{default:o(({row:a})=>[l(u)?c("",!0):(s(),J("span",pe,f(a.courseVenue),1)),l(u)?(s(),d(v,{key:1,modelValue:a.courseVenue,"onUpdate:modelValue":y=>a.courseVenue=y,style:I(l(B))},null,8,["modelValue","onUpdate:modelValue","style"])):c("",!0)]),_:1},8,["label"]),t(g,{"filter-method":A,filters:[{text:e.$t("menu.data.yes"),value:!0},{text:e.$t("menu.data.no"),value:!1}],label:e.$t("menu.data.courseData.courseSpecialized"),"filter-placement":"bottom-end",prop:"courseSpecialized",width:"300px"},{default:o(({row:a})=>[l(u)?c("",!0):(s(),d(ce,{key:0,color:a.courseSpecialized?"blue":"red",class:"font-weight-bold",size:"small"},{default:o(()=>[t(ne,{icon:a.courseSpecialized?"mdi-check-circle-outline":"mdi-close-circle-outline",start:""},null,8,["icon"]),_(" "+f(a.courseSpecialized?e.$t("menu.data.yes"):e.$t("menu.data.no")),1)]),_:2},1032,["color"])),l(u)?(s(),d(z,{key:1,modelValue:a.courseSpecialized,"onUpdate:modelValue":y=>a.courseSpecialized=y,style:I(l(j))},null,8,["modelValue","onUpdate:modelValue","style"])):c("",!0)]),_:1},8,["filters","label"])]),_:1},8,["data","style"])]),_:1})]),_:1}),t(te,null,{default:o(()=>[l(u)?c("",!0):(s(),d(V,{key:0,block:"",class:"mt-2",color:"primary",size:"x-large",onClick:U},{default:o(()=>[_(f(e.$t("menu.data.edit")),1)]),_:1})),$("div",ge,[t(b),l(u)?(s(),d(V,{key:0,class:"mt-2",color:"primary",size:"x-large",onClick:R},{default:o(()=>[_(f(e.$t("menu.data.delete")),1)]),_:1})):c("",!0),t(b),l(u)?(s(),d(V,{key:1,class:"mt-2",color:"primary",size:"x-large",onClick:Q},{default:o(()=>[_(f(e.$t("menu.data.addCourse")),1)]),_:1})):c("",!0),t(b),l(u)?(s(),d(V,{key:2,class:"mt-2",color:"primary",size:"x-large",onClick:G},{default:o(()=>[_(f(e.$t("menu.data.confirm")),1)]),_:1})):c("",!0),t(b),l(u)?(s(),d(V,{key:3,class:"mt-2",color:"primary",size:"x-large",onClick:K},{default:o(()=>[_(f(e.$t("menu.data.revocation")),1)]),_:1})):c("",!0),t(b),l(u)?(s(),d(V,{key:4,class:"mt-2",color:"primary",size:"x-large",onClick:U},{default:o(()=>[_(f(e.$t("menu.data.quitEdit")),1)]),_:1})):c("",!0),t(b)])]),_:1})],64)}}});const _e=ie(he,[["__scopeId","data-v-9c71ee2d"]]);export{_e as default};
