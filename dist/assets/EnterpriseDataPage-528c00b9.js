import{d as j,r as v,A as G,B as H,a as K,b as B,e as g,C,f as S,g as a,w as l,v as Q,D as R,F as W,c as u,E as X,i as T,t as f,G as b,H as Y,I as Z,J as ee,y as o,K as N,p as i,x as h,n as V,q as k,k as x,_ as ae}from"./index-565d8451.js";import{C as te}from"./CopyLabel-c6345122.js";const le={class:"w-25"},oe={key:0},ne={key:0},re={style:{display:"flex","justify-content":"space-between"}},se=j({__name:"EnterpriseDataPage",setup(ue){let n=v(!1),r=v([]);const s=G(),A=H(),y=v(""),J=v([]),d=v([]);K(()=>{U()});function U(){B.get("http://localhost:8089/getEnterpriseData").then(e=>{e.data.code===200?(g(e.data.message,"success"),r.value=e.data.data,localStorage.setItem("enterpriseData",JSON.stringify(r.value))):g(e.data.message,"error")}).catch(e=>{g(e.message,"error")})}const L=C(()=>r.value.filter(e=>!y.value||e.dataName.toLowerCase().includes(y.value.toLowerCase()))),O=C(()=>({"--el-table-tr-bg-color":(s.darkTheme,"null"),"--el-table-bg-color":(s.darkTheme,"null"),"--el-table-header-bg-color":(s.darkTheme,"null"),"--el-table-text-color":s.darkTheme?"#ffffff":"null","--el-table-row-hover-bg-color":s.darkTheme?"#39475e":"#f5f7fa","--el-table-border-color":s.darkTheme?"#253458":"#ebeef5"})),E=C(()=>({"--el-input-bg-color":s.darkTheme?"#1c2742":"#ffffff","--el-input-text-color":s.darkTheme?"#ffffff":"#000000","--el-input-border-color":s.darkTheme?"#b4a8ff":A.themes.value.light.colors.primary}));function I(){var m;const e=((m=localStorage.getItem("enterpriseData"))==null?void 0:m.trim())??"[]",_=JSON.parse(e);if(_.length!==r.value.length){d.value=r.value;return}for(let c=0;c<r.value.length;++c){const D=_[c],t=r.value[c];if(!D&&!t)continue;let p=!1;const M=["dataValue","dataAnnotation"];for(let z of M)if(D[z]!==t[z]){p=!0;break}p&&d.value.push(t)}}function $(){n.value=!n.value}function w(){return d.value.length==0?(g("未修改数据","warning"),!1):!0}function P(){I(),w()&&(console.log(d.value),B.post("http://localhost:8089/updateEnterpriseData",d.value).then(e=>{e.data.code===200?(g(e.data.message,"success"),d.value=[],localStorage.setItem("enterpriseData",JSON.stringify(r.value))):g(e.data.message,"error")}).catch(e=>{console.log(e)}))}function F(){var e;I(),w()&&(r.value=(e=localStorage.getItem("enterpriseData"))!=null&&e.trim()?JSON.parse(localStorage.getItem("enterpriseData").trim()):[],d.value=[])}function q(e){J.value=e}return(e,_)=>{const m=x("el-table-column"),c=x("el-input"),D=x("el-table");return u(),S(W,null,[a(Q,null,{default:l(()=>[a(X,{class:"font-weight-bold"},{default:l(()=>[T("span",null,f(e.$t("menu.data.enterpriseData.enterpriseData")),1),a(b),T("div",le,[a(Y,{modelValue:y.value,"onUpdate:modelValue":_[0]||(_[0]=t=>y.value=t),placeholder:e.$t("menu.data.enterpriseData.search"),clearable:"",density:"compact","hide-details":"","prepend-inner-icon":"mdi-magnify","single-line":"",variant:"solo"},null,8,["modelValue","placeholder"])])]),_:1}),a(Z),a(ee,{class:"table-container"},{default:l(()=>[a(D,{data:o(L),"default-sort":{prop:"courseId",order:"desc"},style:N(o(O)),onSelectionChange:q},{default:l(()=>[a(m,{label:e.$t("menu.data.enterpriseData.dataName"),prop:"courseName",width:"350"},{default:l(({row:t})=>[a(te,{text:t.dataName},null,8,["text"])]),_:1},8,["label"]),a(m,{label:e.$t("menu.data.enterpriseData.dataValue"),prop:"courseVenue",width:"550"},{default:l(({row:t})=>[o(n)?i("",!0):(u(),S("span",oe,f(t.dataValue),1)),o(n)?(u(),h(c,{key:1,modelValue:t.dataValue,"onUpdate:modelValue":p=>t.dataValue=p,style:N(o(E))},null,8,["modelValue","onUpdate:modelValue","style"])):i("",!0)]),_:1},8,["label"]),a(m,{label:e.$t("menu.data.enterpriseData.dataAnnotation"),prop:"coursePeriod"},{default:l(({row:t})=>[o(n)?i("",!0):(u(),S("span",ne,f(t.dataAnnotation),1)),o(n)?(u(),h(c,{key:1,modelValue:t.dataAnnotation,"onUpdate:modelValue":p=>t.dataAnnotation=p,style:N(o(E))},null,8,["modelValue","onUpdate:modelValue","style"])):i("",!0)]),_:1},8,["label"])]),_:1},8,["data","style"])]),_:1})]),_:1}),a(R,null,{default:l(()=>[o(n)?i("",!0):(u(),h(k,{key:0,block:"",class:"mt-2",color:"primary",size:"x-large",onClick:$},{default:l(()=>[V(f(e.$t("menu.data.edit")),1)]),_:1})),T("div",re,[a(b),o(n)?(u(),h(k,{key:0,class:"mt-2",color:"primary",size:"x-large",onClick:P},{default:l(()=>[V(f(e.$t("menu.data.confirm")),1)]),_:1})):i("",!0),a(b),o(n)?(u(),h(k,{key:1,class:"mt-2",color:"primary",size:"x-large",onClick:F},{default:l(()=>[V(f(e.$t("menu.data.revocation")),1)]),_:1})):i("",!0),a(b),o(n)?(u(),h(k,{key:2,class:"mt-2",color:"primary",size:"x-large",onClick:$},{default:l(()=>[V(f(e.$t("menu.data.quitEdit")),1)]),_:1})):i("",!0),a(b)])]),_:1})],64)}}});const ce=ae(se,[["__scopeId","data-v-673c28d6"]]);export{ce as default};
